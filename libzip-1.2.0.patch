diff --git a/CMakeLists.txt b/CMakeLists.txt
index d443757..0095507 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -100,6 +100,9 @@ ENDIF(ZLIB_VERSION_STRING VERSION_LESS "1.1.2")
 
 IF(MSVC)
 ADD_DEFINITIONS("-D_CRT_SECURE_NO_WARNINGS")
+IF(CMAKE_SIZEOF_VOID_P EQUAL 4)
+ADD_DEFINITIONS("-D_USE_32BIT_TIME_T=1")
+ENDIF(CMAKE_SIZEOF_VOID_P EQUAL 4)
 ENDIF(MSVC)
 
 ADD_DEFINITIONS("-DHAVE_CONFIG_H")
diff --git a/lib/CMakeLists.txt b/lib/CMakeLists.txt
index 1596f30..9b2b15a 100644
--- a/lib/CMakeLists.txt
+++ b/lib/CMakeLists.txt
@@ -191,19 +191,20 @@ IF(NOT HAVE_MKSTEMP)
   SET(LIBZIP_EXTRA_FILES mkstemp.c)
 ENDIF(NOT HAVE_MKSTEMP)
 
-ADD_LIBRARY(zip SHARED ${LIBZIP_SOURCES} ${LIBZIP_EXTRA_FILES} ${LIBZIP_OPSYS_FILES})
-SET_TARGET_PROPERTIES(zip PROPERTIES VERSION 3.0 SOVERSION 3 )
-TARGET_LINK_LIBRARIES(zip ${ZLIB_LIBRARY})
-INSTALL(TARGETS zip
+ADD_LIBRARY(libzip SHARED ${LIBZIP_SOURCES} ${LIBZIP_EXTRA_FILES} ${LIBZIP_OPSYS_FILES})
+SET_TARGET_PROPERTIES(libzip PROPERTIES VERSION 3.0 SOVERSION 3 )
+TARGET_LINK_LIBRARIES(libzip ${ZLIB_LIBRARY})
+INSTALL(TARGETS libzip
   RUNTIME DESTINATION bin
   ARCHIVE DESTINATION lib
   LIBRARY DESTINATION lib)
-#CREATE_LIBTOOL_FILE(zip lib)
+#CREATE_LIBTOOL_FILE(libzip lib)
+
+ADD_LIBRARY(libzip_a STATIC ${LIBZIP_SOURCES} ${LIBZIP_EXTRA_FILES} ${LIBZIP_OPSYS_FILES})
+SET_TARGET_PROPERTIES(libzip_a PROPERTIES VERSION 3.0 SOVERSION 3 )
+TARGET_LINK_LIBRARIES(libzip_a ${ZLIB_LIBRARY})
+INSTALL(TARGETS libzip_a
+  RUNTIME DESTINATION bin
+  ARCHIVE DESTINATION lib
+ LIBRARY DESTINATION lib)
 
-#ADD_LIBRARY(zipstatic STATIC ${LIBZIP_SOURCES} ${LIBZIP_EXTRA_FILES} ${LIBZIP_OPSYS_FILES})
-#SET_TARGET_PROPERTIES(zipstatic PROPERTIES VERSION 3.0 SOVERSION 3 )
-#TARGET_LINK_LIBRARIES(zipstatic ${ZLIB_LIBRARY})
-#INSTALL(TARGETS zipstatic
-#  RUNTIME DESTINATION bin
-#  ARCHIVE DESTINATION lib
-#  LIBRARY DESTINATION lib)
