diff --git a/CMakeLists.txt b/CMakeLists.txt
index 69cdb8b..e57046c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -131,6 +131,9 @@ ENDIF(BZIP2_FOUND)
 IF(MSVC)
 ADD_DEFINITIONS("-D_CRT_SECURE_NO_WARNINGS")
 ADD_DEFINITIONS("-D_CRT_NONSTDC_NO_DEPRECATE")
+IF(CMAKE_SIZEOF_VOID_P EQUAL 4)
+ADD_DEFINITIONS("-D_USE_32BIT_TIME_T=1")
+ENDIF(CMAKE_SIZEOF_VOID_P EQUAL 4)
 ENDIF(MSVC)
 
 if(CMAKE_SYSTEM_NAME MATCHES WindowsPhone OR CMAKE_SYSTEM_NAME MATCHES WindowsStore)
diff --git a/lib/CMakeLists.txt b/lib/CMakeLists.txt
index 855ccf5..d85b40c 100644
--- a/lib/CMakeLists.txt
+++ b/lib/CMakeLists.txt
@@ -199,10 +199,10 @@ IF(NOT HAVE_MKSTEMP)
   SET(LIBZIP_EXTRA_FILES mkstemp.c)
 ENDIF(NOT HAVE_MKSTEMP)
 
-ADD_LIBRARY(zip ${LIBZIP_SOURCES} ${LIBZIP_EXTRA_FILES} ${LIBZIP_OPSYS_FILES})
-SET_TARGET_PROPERTIES(zip PROPERTIES VERSION 5.0 SOVERSION 5)
-TARGET_LINK_LIBRARIES(zip ${ZLIB_LIBRARY} ${OPTIONAL_LIBRARY})
-INSTALL(TARGETS zip
+ADD_LIBRARY(libzip_a STATIC ${LIBZIP_SOURCES} ${LIBZIP_EXTRA_FILES} ${LIBZIP_OPSYS_FILES})
+SET_TARGET_PROPERTIES(libzip_a PROPERTIES VERSION 5.0 SOVERSION 5)
+TARGET_LINK_LIBRARIES(libzip_a ${ZLIB_LIBRARY} ${OPTIONAL_LIBRARY})
+INSTALL(TARGETS libzip_a
   RUNTIME DESTINATION bin
   ARCHIVE DESTINATION lib
   LIBRARY DESTINATION lib)
